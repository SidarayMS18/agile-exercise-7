<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Vintage Car Auction</title>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
        <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f6fa;
      color: #23272f;
      min-height: 100vh;
    }
    header {
      background: linear-gradient(90deg, #1a2238 70%, #283655 100%);
      padding: 24px 0 18px 0;
      text-align: left;
      color: #fff;
      box-shadow: 0 4px 24px rgba(30,40,60,0.08);
      position: relative;
    }
    .header-content {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      font-size: 2.2em;
      font-weight: 700;
      letter-spacing: 2px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo i {
      font-size: 1.2em;
      color: #ffd700;
    }
    .header-actions {
      display: flex;
      gap: 18px;
      align-items: center;
    }
    .dark-mode-btn, #logoutBtn {
      padding: 10px 22px;
      background: #ffd700;
      color: #1a2238;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1.1em;
      border: none;
      font-weight: 600;
      transition: background 0.3s, color 0.3s;
      box-shadow: 0 2px 8px rgba(30,40,60,0.04);
    }
    .dark-mode-btn:hover, #logoutBtn:hover {
      background: #23272f;
      color: #ffd700;
    }
    #logoutBtn {
      display: none;
    }
    .container {
      width: 95%;
      max-width: 1200px;
      margin: 32px auto 0 auto;
    }
    .overview {
      background: linear-gradient(135deg, #23272f 70%, #283655 100%);
      padding: 48px 32px;
      margin-top: 30px;
      border-radius: 18px;
      box-shadow: 0 6px 32px rgba(30,40,60,0.10);
      color: #fff;
      text-align: center;
    }
    .overview h2, .overview h3 {
      font-family: 'Bebas Neue', cursive, sans-serif;
      letter-spacing: 2px;
      font-weight: 400;
      text-transform: uppercase;
  }
    .overview p, .overview ul li {
      font-size: 1.25em;
      margin-bottom: 10px;
    }
    .overview ul {
      list-style: none;
      padding: 0;
      margin-bottom: 28px;
    }
    .overview button {
      padding: 16px 36px;
      background: #ffd700;
      color: #1a2238;
      border: none;
      border-radius: 32px;
      font-size: 1.3em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(30,40,60,0.06);
      transition: background 0.3s, color 0.3s;
    }
    .overview button:hover {
      background: #23272f;
      color: #ffd700;
    }
    .login-form {
      background: #fff;
      padding: 36px 28px;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(30,40,60,0.10);
      max-width: 400px;
      margin: 32px auto;
      text-align: center;
    }
    .login-form input {
      padding: 14px;
      margin: 12px 0;
      width: 100%;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 1.1em;
      background: #f9f9f9;
      transition: border 0.2s;
    }
    .login-form input:focus {
      border: 2px solid #ffd700;
      outline: none;
    }
    .login-form button {
      padding: 14px 0;
      background: linear-gradient(90deg, #ffd700 60%, #ffb300 100%);
      color: #23272f;
      border: none;
      border-radius: 30px;
      font-size: 1.2em;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: background 0.3s, color 0.3s;
    }
    .login-form button:hover {
      background: #23272f;
      color: #ffd700;
    }
    #mainContent {
      display: none;
    }
    .car {
      background: #fff;
      margin-bottom: 32px;
      border-radius: 18px;
      box-shadow: 0 4px 24px rgba(30,40,60,0.10);
      padding: 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .car:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 8px 32px rgba(40,54,85,0.13);
    }
    .car img {
      width: 170px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(30,40,60,0.08);
      border: 3px solid #ffd70033;
      background: #fff;
    }
    .car-details {
      flex-grow: 1;
      margin-left: 32px;
      min-width: 0;
    }
    .car-details h2 {
      font-size: 2em;
      margin: 0 0 8px 0;
      color: #1a2238;
      font-weight: 700;
    }
    .car-details p {
      margin: 6px 0;
      font-size: 1.1em;
    }
    .timer {
      font-weight: 600;
      color: #283655;
    }
    .bid-section {
      min-width: 220px;
      text-align: right;
    }
    .bid-section label {
      font-weight: 600;
      margin-bottom: 6px;
      display: block;
    }
    .bid-section input {
      padding: 10px;
      width: 120px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 1.1em;
      margin-bottom: 8px;
      background: #f9f9f9;
      transition: border 0.2s;
    }
    .bid-section input:focus {
      border: 2px solid #ffd700;
      outline: none;
    }
    .bid-section button {
      padding: 10px 24px;
      background: linear-gradient(90deg, #ffd700 60%, #ffb300 100%);
      color: #23272f;
      border: none;
      border-radius: 30px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      margin-top: 6px;
      transition: background 0.3s, color 0.3s;
    }
    .bid-section button:hover {
      background: #23272f;
      color: #ffd700;
    }
    .balance-section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(30,40,60,0.06);
      padding: 18px 24px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 24px;
      justify-content: space-between;
    }
    .balance-section h3 {
      margin: 0;
      font-size: 1.3em;
      color: #1a2238;
      font-weight: 700;
    }
    .balance-section input[type="number"] {
      width: 120px;
      margin-right: 8px;
    }
    .sort-bar {
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .sort-bar label {
      font-weight: 600;
    }
    .bid-history-section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(30,40,60,0.06);
      padding: 18px 24px;
      margin-top: 32px;
    }
    .bid-history-section h3 {
      margin-top: 0;
      color: #1a2238;
      font-weight: 700;
    }
    .bid-history-section ul {
      padding-left: 18px;
      font-size: 1.1em;
    }
    /* Responsive */
    @media (max-width: 900px) {
      .car {
        flex-direction: column;
        align-items: flex-start;
      }
      .car img {
        width: 100%;
        margin-bottom: 18px;
      }
      .car-details {
        margin-left: 0;
        margin-bottom: 18px;
      }
      .bid-section {
        text-align: left;
        min-width: 0;
      }
    }
    /* Dark Mode Styles */
    body.dark-mode {
      background: #181818;
      color: #eee;
    }
    body.dark-mode header {
      background: #23272f;
    }
    body.dark-mode .dark-mode-btn,
    body.dark-mode #logoutBtn {
      background: #23272f;
      color: #ffd700;
      border: 1px solid #ffd700;
    }
    body.dark-mode .dark-mode-btn:hover,
    body.dark-mode #logoutBtn:hover {
      background: #ffd700;
      color: #23272f;
    }
    body.dark-mode .overview,
    body.dark-mode .login-form,
    body.dark-mode .car,
    body.dark-mode .balance-section,
    body.dark-mode .bid-history-section {
      background: #23272f;
      color: #ffd700;
    }
    body.dark-mode input,
    body.dark-mode select {
      background-color: #444;
      color: #ffd700;
      border-color: #ffd700;
    }
    body.dark-mode .overview button,
    body.dark-mode .login-form button,
    body.dark-mode .bid-section button {
      background: #ffd700;
      color: #23272f;
    }
    body.dark-mode .overview button:hover,
    body.dark-mode .login-form button:hover,
    body.dark-mode .bid-section button:hover {
      background: #23272f;
      color: #ffd700;
    }
  </style>
      </head>
      <body>
        <header>
          <div class="header-content">
            <span class="logo"><i class="fa-solid fa-car-side"></i> Vintage Car Auction</span>
            <div class="header-actions">
              <button class="dark-mode-btn" onclick="toggleDarkMode()"><i class="fa-solid fa-moon"></i> Dark Mode</button>
              <button id="logoutBtn" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
            </div>
          </div>
        </header>

  <div class="container">
   <div id="overviewPage" class="overview">
  <h2>Auction Guidelines</h2>
  <ul>
    <li><strong>Account Setup:</strong> Create or log in to your account to participate.</li>
    <li><strong>Add Funds:</strong> Ensure your account has sufficient balance before placing bids.</li>
    <li><strong>Bidding Process:</strong> Place your bids in real-time. Each car will have a live countdown timer.</li>
    <li><strong>Winning Criteria:</strong> The highest valid bid when the timer expires secures the vehicle.</li>
    <li><strong>Fair Play:</strong> All bids are final. No bid retractions are allowed once submitted.</li>
  </ul>
  <h3>How to Get Started</h3>
  <ul>
    <li>Register or Log In</li>
    <li>Browse Vintage Cars</li>
    <li>Add Funds to Your Wallet</li>
    <li>Join the Auction and Start Bidding</li>
  </ul>
  <h3>Ready to Join the Action?</h3>
  <button onclick="showLoginPage()" style="background: #ffd700; color: #1a2238;">Login and Start Bidding</button>
</div>

    <div id="loginForm" class="login-form" style="display:none;">
      <h2>Customer Login</h2>
      <input type="text" id="username" placeholder="Username">
      <input type="password" id="password" placeholder="Password">
      <button onclick="login()">Login</button>
      <p>don't have an account?</p>
      <a style="color: cornflowerblue;">Signup</a>
    </div>

    <div id="mainContent">
      <div class="balance-section">
        <h3>Welcome, <span id="userDisplay"></span></h3>
        <p>Balance: ₹<span id="balance">0</span></p>
        <input type="number" id="funds" placeholder="Add funds">
        <button onclick="addFunds()">Add Funds</button>
      </div>

      <div class="sort-bar">
        <label for="sort">Sort Cars By:</label>
        <select id="sort" onchange="sortCars()">
          <option value="name">Name</option>
          <option value="price">Current Bid</option>
        </select>
      </div>

      <div id="carsContainer"></div>

      <div class="bid-history-section">
        <h3>Your Bid History</h3>
        <ul id="bidHistory"></ul>
      </div>
    </div>
  </div>

  <script>
    let currentUser = "";
    let userBalance = 0;
    let bidHistory = [];

    const cars = [
  {
    name: "1965 Ford Mustang",
    location: "Bangalore,Karnataka",
    image: "https://i.imgur.com/ZVx8f1t.jpg",
    currentBid: 120000,
    timer: 1200,
    id: 1
  },
  {
    name: "1957 Chevrolet Bel Air",
    location: "Bhubaneswar, Odisha",
    image: "https://i.imgur.com/BvF1bNw.jpg",
    currentBid: 140000,
    timer: 90,
    id: 2
  },
  {
    name: "1963 Jaguar E-Type",
    location: "Udaipur, Rajasthan",
    image: "https://i.imgur.com/1n8pQ6t.jpg",
    currentBid: 200000,
    timer: 150,
    id: 3
  },
  {
    name: "1970 Dodge Charger",
    location: "Chittorgarh, Rajasthan",
    image: "https://i.imgur.com/8zQbQkI.jpg",
    currentBid: 180000,
    timer: 110,
    id: 4
  }
];

function login() {
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  if (username && password) {
    // Updated the fetch URL to ensure it matches the server endpoint
    fetch("http://127.0.0.1:8080/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
      },
      body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`,
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          currentUser = username;
          document.getElementById("loginForm").style.display = "none";
          document.getElementById("mainContent").style.display = "block";
          document.getElementById("overviewPage").style.display = "none";
          // Ensure the element exists before setting its textContent
          const userDisplayElement = document.getElementById("userDisplay");
          if (userDisplayElement) {
            userDisplayElement.textContent = username;
          } else {
            console.error("Element with id 'userDisplay' not found in the DOM.");
          }
          document.getElementById("logoutBtn").style.display = "inline-block";
          renderCars();
        } else {
          alert(data.message);
        }
      })
      .catch((error) => {
        console.error("Error:", error);
        alert("An error occurred. Please try again.");
      });
  } else {
    alert("Enter username and password.");
  }
}

function logout() {
  currentUser = "";
  userBalance = 0;
  bidHistory = [];
  document.getElementById("mainContent").style.display = "none";
  document.getElementById("overviewPage").style.display = "block";
  document.getElementById("logoutBtn").style.display = "none";
  document.getElementById("balance").textContent = "0";
  document.getElementById("funds").value = "";
  document.getElementById("bidHistory").innerHTML = "";
  document.getElementById("loginForm").style.display = "none"; // Hide login form
}

function showLoginPage() {
  document.getElementById("overviewPage").style.display = "none";
  document.getElementById("loginForm").style.display = "block";
  document.getElementById("logoutBtn").style.display = "none";
}

    function addFunds() {
      const funds = parseInt(document.getElementById("funds").value);
      if (!isNaN(funds) && funds > 0) {
        userBalance += funds;
        document.getElementById("balance").textContent = userBalance;
        alert("Funds added!");
      } else {
        alert("Enter a valid amount.");
      }
    }

    function placeBid(carId) {
      const bidInput = document.getElementById("bid-" + carId);
      const newBid = parseInt(bidInput.value);
      const car = cars.find(c => c.id === carId);

      if (newBid > car.currentBid) {
        if (userBalance >= newBid) {
          car.currentBid = newBid;
          userBalance -= newBid;
          bidHistory.push(`${car.name}: ₹${newBid}`);
          updateUI();
          alert("Bid placed!");
        } else {
          alert("Not enough balance.");
        }
      } else {
        alert("Bid must be higher.");
      }
    }

    function updateUI() {
      document.getElementById("balance").textContent = userBalance;
      renderCars();
      const bidList = document.getElementById("bidHistory");
      bidList.innerHTML = "";
      bidHistory.forEach(bid => {
        const li = document.createElement("li");
        li.textContent = bid;
        bidList.appendChild(li);
      });
    }

function renderCars() {
  const container = document.getElementById("carsContainer");
  container.innerHTML = "";
  cars.forEach(car => {
    const isAuctionEnded = car.timer <= 0;
    const carDiv = document.createElement("div");
    carDiv.className = "car";
    carDiv.innerHTML = `
      <img src="${car.image}" alt="${car.name}">
      <div class="car-details">
        <h2>${car.name}</h2>
        <p>Location: ${car.location}</p>
        <p>Current Bid: ₹<span id="currentBid-${car.id}">${car.currentBid}</span></p>
        <p class="timer">Auction Ends In: <span id="timer-${car.id}">${formatTime(car.timer)}</span></p>
        <p id="endMsg-${car.id}" style="color: green;"></p>
      </div>
      <div class="bid-section">
        <label>Your Bid: ₹</label>
        <input type="number" id="bid-${car.id}" min="${car.currentBid + 1}" ${isAuctionEnded ? "disabled" : ""}>
        <button onclick="placeBid(${car.id})" ${isAuctionEnded ? "disabled" : ""}>Place Bid</button>
      </div>
    `;
    container.appendChild(carDiv);
  });
}

function placeBid(carId) {
  const car = cars.find(c => c.id === carId);
  if (car.timer <= 0) {
    alert("Auction has ended for this car. You cannot place a bid.");
    return;
  }
  const bidInput = document.getElementById("bid-" + carId);
  const newBid = parseInt(bidInput.value);

  if (newBid > car.currentBid) {
    if (userBalance >= newBid) {
      car.currentBid = newBid;
      userBalance -= newBid;
      bidHistory.push(`${car.name}: ₹${newBid}`);
      updateUI();
      alert("Bid placed!");
    } else {
      alert("Not enough balance.");
    }
  } else {
    alert("Bid must be higher.");
  }
}

function startCountdowns() {
  setInterval(() => {
    cars.forEach(car => {
      if (car.timer > 0) {
        car.timer--;
        document.getElementById(`timer-${car.id}`).textContent = formatTime(car.timer);
        if (car.timer === 0) {
          document.getElementById(`timer-${car.id}`).textContent = "00:00";
          document.getElementById(`endMsg-${car.id}`).textContent = `Auction Ended. Highest Bid: $${car.currentBid}`;
          renderCars(); // Re-render to disable bid controls
        }
      } else {
        document.getElementById(`timer-${car.id}`).textContent = "00:00";
        document.getElementById(`endMsg-${car.id}`).textContent = `Auction Ended. Highest Bid: $${car.currentBid}`;
      }
    });
  }, 1000);
}

    function startCountdowns() {
      setInterval(() => {
        cars.forEach(car => {
          if (car.timer > 0) {
            car.timer--;
            document.getElementById(`timer-${car.id}`).textContent = formatTime(car.timer);
          } else {
            document.getElementById(`timer-${car.id}`).textContent = "00:00";
            document.getElementById(`endMsg-${car.id}`).textContent = `Auction Ended. Highest Bid: $${car.currentBid}`;
          }
        });
      }, 1000);
    }

    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const sec = seconds % 60;
      return `${minutes.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }

    function showLoginPage() {
      document.getElementById("overviewPage").style.display = "none";
      document.getElementById("loginForm").style.display = "block";
    }

    function sortCars() {
      const sortValue = document.getElementById("sort").value;
      if (sortValue === "name") {
        cars.sort((a, b) => a.name.localeCompare(b.name));
      } else if (sortValue === "price") {
        cars.sort((a, b) => b.currentBid - a.currentBid);
      }
      renderCars();
    }

    startCountdowns();
    window.onload = function() {
  // Initial state: show overview, hide login and main content, hide logout
  document.getElementById("overviewPage").style.display = "block";
  document.getElementById("loginForm").style.display = "none";
  document.getElementById("mainContent").style.display = "none";
  document.getElementById("logoutBtn").style.display = "none";
};
  </script>
</body>
</html>